import express from "express";
import cors from "cors";
import dotenv from "dotenv";
import { Models } from "@google/genai";
const app=express();
dotenv.config();
app.use(cors());
app.use(express.json());
function formatHistoryForGemini(openAIMessages) {
  return openAIMessages
    .filter(msg => msg.role !== 'system') // Filter out system messages (handle separately)
    .map(msg => ({
      role: msg.role === 'assistant' ? 'model' : 'user',
      parts: [{ text: msg.content }]
    }));
}
app.post("/api/generate",async(req,res)=>{
  const options={
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":`Bearer ${process.env.GEMINI_API_KEY}`
    },
    body:JSON.stringify({
      Models: "gemini-1.5-turbo",
      messages :[{
        role: "user",
        parts: [{ text: "Hello, how are you?" }]
      }]
    })
  };
  try{
    const response=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-turbo:generateContent",options)
    const data=await response.json();
    console.log("Gemini Response:",data);
    res.json({response:data});
  }catch(error){
    console.error("Error:",error);
    res.status(500).json({error:"Internal Server Error"});
  }
})
const PORT=8080;
app.listen(PORT,()=>{
  console.log(`Server is running on port localhost:${PORT}`);
})
